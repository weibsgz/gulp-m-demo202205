/*! xcar_touch - v1.0.0 - */!function(a,b){"function"==typeof define&&define.cmd?define("nshare",["jweixin","jxcar"],function(c){var d=c("jweixin"),e=c("jxcar");return b(a,d,e)}):b(a)}(window,function(a,b,c){var d=a,e=b||a.wx,f=c||a.xcarjsapi,g=0;if(!e)return console.log("错误：未引入jweixin"),!1;if(!f)return console.log("错误：未引入xcarjsapi"),!1;if(!d.nshare){var h=d.nshare={version:"1.0.0"};h.wxapi=e,h.jxcar=f;var i=h.data={api:"//a.xcar.com.cn/jssdk/wxsdk.php"},j=i.events={},k=(h.bind=h.on=function(a,b){var c=j[a]||(j[a]=[]);return c.push(b),h},h.unbind=h.off=function(a,b){if(!a&&!b)return j=i.events={},h;var c=j[a];if(c)if(b)for(var d=c.length-1;d>=0;d--)c[d]===b&&c.splice(d,1);else delete j[a];return h},h.trigger=h.emit=function(a,b){var c,d=j[a];if(d)for(d=d.slice();c=d.shift();)c(b);return h},function(a,b){return(a+"&"+b).replace(/[&?]{1,2}/,"?")}),l=function(b){var c=d.document;b.url=k(b.url,"callback=?");var e,f=b.jsonpCallback||"jsonp"+ ++g,h=c.createElement("script"),i=function(){clearTimeout(e),null!=h.parentNode&&h.parentNode.removeChild(h),delete a[f]},j=function(b){i(),b&&"timeout"!=b||(a[f]=function(){})},l={abort:j};return a[f]=function(a){i(),b.success&&b.success(a,l,b)},h.onerror=function(){j("abort"),b.error&&b.error()},h.src=b.url.replace(/=\?/,"="+f),c.getElementsByTagName("head")[0].appendChild(h),b.timeout>0&&(e=setTimeout(function(){j("abort"),b.error&&error()},b.timeout)),l};return h.jxcar.on("share",function(a){h.emit("share",a)}),h.ready=function(a){e.ready(function(){e.status=1,h.setwxdata(a)})},h.setwxdata=function(a){var b=["Timeline","AppMessage","QQ","Weibo","QZone"];if(e.status)for(var c=0,d=b.length;d>c;c++){var f=b[c],g=e["onMenuShare"+f];g&&g({title:a.title,desc:a.desc,link:a.url,imgUrl:a.pic,type:"",dataUrl:"",success:function(a){h.emit(f.toLowerCase()+"success",a)},cancel:function(a){h.emit(f.toLowerCase()+"cancel",a)},fail:function(a){h.emit(f.toLowerCase()+"fail",a)},complete:function(a){h.emit(f.toLowerCase()+"complete",a)},trigger:function(a){h.emit(f.toLowerCase()+"trigger",a)}})}else{var j=(location.href,i.api);l({type:"GET",url:j+"?url="+encodeURIComponent(location.href),jsonp:"callback",timeout:2e4,success:function(b){var c=JSON.parse(b);c.jsApiList=["onMenuShareTimeline","onMenuShareAppMessage","onMenuShareQQ","onMenuShareWeibo","onMenuShareQzone","hideOptionMenu","showOptionMenu"],e.config(c),h.ready(a)}})}},h.setxcardata=function(a){f.status?f.shareInfo&&f.shareInfo({data:{title:a.title,message:a.desc,targetUrl:a.url,imageUrl:a.pic}}):f.ready(function(){f.status=1,f.shareInfo&&f.shareInfo({data:{title:a.title,message:a.desc,targetUrl:a.url,imageUrl:a.pic}})})},h.setdata=function(a){f.isSupport()?h.setxcardata(a):/MicroMessenger\/([\d\.]+)/.test(navigator.userAgent)&&h.setwxdata(a)},h}});